# Business-inteligence-

1. List all the files that this program generates.
  - price_list.csv
  - price_list.txt
  - prices.png
  
2. Describe which types of files this program generates and attach the contents of each file together with its name to your solution.
  The program program generates 3 files. 1 csv, 1 txt and 1 png file 

  - price_list.csv:

  street,city,price,sqm,price_per_sqm
"Ved Volden 5, 5. TV",1425 København K,4000000,91,43956
"Rådhusstræde 4C, 1",1466 København K,4895000,105,46619
"Store Kongensgade 112A, 3",1264 København K,250000,135,1851
"Amaliegade 13G, 2",1256 København K,7375000,98,75255
"Borgergade 144, 3. TH",1300 København K,5825000,101,57673
"Nørre Søgade 9A, 1. TH",1370 København K,1126250,107,10525
"Wildersgade 22, ST",1408 København K,1556700,88,17689
"Toldbodgade 10A, 1",1253 København K,3750000,184,20380
"Andreas Bjørns Gade 4, 3. TH",1428 København K,1700000,54,31481
"Sølvgade 15, 4. TH",1307 København K,4215000,81,52037
"Linnésgade 16A, 1",1361 København K,6300000,155,40645
"Store Kongensgade 63A, ST. 4",1264 København K,1780000,98,18163
"Peder Skrams Gade 28, 2. TV",1054 København K,4080000,76,53684
"Brobergsgade 14, 1. TV",1427 København K,2750000,50,55000
"Sølvgade 13, 2. TV",1307 København K,3150000,73,43150
"Ny Adelgade 9, 2. TH",1104 København K,1950000,70,27857
"Lavendelstræde 9, 2. TV",1462 København K,1550000,66,23484
"Åbenrå 10, 2. 5",1124 København K,1650000,70,23571
"Grønnegade 31, 3. TV",1107 København K,1200000,49,24489
"Badstuestræde 16, 2",1209 København K,2700000,97,27835
"Nørre Voldgade 70, 4",1358 København K,1870000,99,18888
"Fredericiagade 25, 5. 1",1310 København K,3150000,118,26694
"Sølvgade 19, 2. MF",1307 København K,2425000,49,49489
"David Balfours Gade 3, ST. TV",1402 København K,3100000,83,37349
"Vimmelskaftet 36A, 3. TH",1161 København K,3695000,84,43988
"Store Kongensgade 110C, 3. TV",1264 København K,3050000,118,25847
"Andreas Bjørns Gade 10, 3. TV",1428 København K,2367000,53,44660
"Grønnegade 31, 4",1107 København K,3950000,73,54109
"Peder Skrams Gade 27, 3. TH",1054 København K,6250000,112,55803
"Andreas Bjørns Gade 22, 3. TH",1428 København K,2900000,55,52727
"Kronprinsessegade 10, 4. TV",1306 København K,4350000,101,43069
"Bartholinsgade 11, 1. TV",1356 København K,841000,52,16173
"Sankt Peders Stræde 17, 2",1453 København K,4125000,106,38915
"Ved Volden 11, 4. TH",1425 København K,4900000,97,50515
Luftmarinegade 38,1432 København K,2485131,137,18139
"Gernersgade 5, ST. TV",1319 København K,1950000,37,52702
"Ahlefeldtsgade 26, 4. TV",1359 København K,2115000,82,25792
"Dronningens Tværgade 36, 4. 1",1302 København K,1785000,82,21768
"Nikolajgade 20, 2. TV",1068 København K,3500000,92,38043
"Strandgade 12, 3",1401 København K,7170000,228,31447
"Store Kongensgade 90, 2. TH",1264 København K,7500000,158,47468
"Gothersgade 147, 3. TV",1123 København K,3622500,68,53272


  - price_list.txt:

  * Ved Volden 5, 5. TV; 1425 København K	4000000	91
  * Rådhusstræde 4C, 1; 1466 København K	4895000	105
  * Store Kongensgade 112A, 3; 1264 København K	250000	135
  * Amaliegade 13G, 2; 1256 København K	7375000	98
  * Borgergade 144, 3. TH; 1300 København K	5825000	101
  * Nørre Søgade 9A, 1. TH; 1370 København K	1126250	107
  * Wildersgade 22, ST; 1408 København K	1556700	88
  * Toldbodgade 10A, 1; 1253 København K	3750000	184
  * Andreas Bjørns Gade 4, 3. TH; 1428 København K	1700000	54
  * Sølvgade 15, 4. TH; 1307 København K	4215000	81
  * Linnésgade 16A, 1; 1361 København K	6300000	155
  * Store Kongensgade 63A, ST. 4; 1264 København K	1780000	98
  * Peder Skrams Gade 28, 2. TV; 1054 København K	4080000	76
  * Brobergsgade 14, 1. TV; 1427 København K	2750000	50
  * Sølvgade 13, 2. TV; 1307 København K	3150000	73
  * Ny Adelgade 9, 2. TH; 1104 København K	1950000	70
  * Lavendelstræde 9, 2. TV; 1462 København K	1550000	66
  * Åbenrå 10, 2. 5; 1124 København K	1650000	70
  * Grønnegade 31, 3. TV; 1107 København K	1200000	49
  * Badstuestræde 16, 2; 1209 København K	2700000	97
  * Nørre Voldgade 70, 4; 1358 København K	1870000	99
  * Fredericiagade 25, 5. 1; 1310 København K	3150000	118
  * Sølvgade 19, 2. MF; 1307 København K	2425000	49
  * David Balfours Gade 3, ST. TV; 1402 København K	3100000	83
  * Vimmelskaftet 36A, 3. TH; 1161 København K	3695000	84
  * Store Kongensgade 110C, 3. TV; 1264 København K	3050000	118
  * Andreas Bjørns Gade 10, 3. TV; 1428 København K	2367000	53
  * Grønnegade 31, 4; 1107 København K	3950000	73
  * Peder Skrams Gade 27, 3. TH; 1054 København K	6250000	112
  * Andreas Bjørns Gade 22, 3. TH; 1428 København K	2900000	55
  * Kronprinsessegade 10, 4. TV; 1306 København K	4350000	101
  * Bartholinsgade 11, 1. TV; 1356 København K	841000	52
  * Sankt Peders Stræde 17, 2; 1453 København K	4125000	106
  * Ved Volden 11, 4. TH; 1425 København K	4900000	97
  * Luftmarinegade 38; 1432 København K	2485131	137
  * Gernersgade 5, ST. TV; 1319 København K	1950000	37
  * Ahlefeldtsgade 26, 4. TV; 1359 København K	2115000	82
  * Dronningens Tværgade 36, 4. 1; 1302 København K	1785000	82
  * Nikolajgade 20, 2. TV; 1068 København K	3500000	92
  * Strandgade 12, 3; 1401 København K	7170000	228
  * Store Kongensgade 90, 2. TH; 1264 København K	7500000	158
  * Gothersgade 147, 3. TV; 1123 København K	3622500	68
  
  - prices.png
  
![Alt text](https://github.com/pilgaard/Business-inteligence-/blob/master/prices.png)  

3. What is the output of this program?
  - 3307228.119047619
4. Describe in natural language and line-by-line what the program is doing. Describe also for each line what the Python code expresses.

```python
# her har vi en del moduler som bliver importeret ind i programmet
import os
import csv
import requests
import platform
import statistics
import matplotlib
# her får matplotlib at vide det skal bruge agg
matplotlib.use('agg')
# her importere vi igen et modul og derefter omdøber det til plt
import matplotlib.pyplot as plt

# her definerer vi en metode kaldet download_txt, metoden tager to argumenter url og save_path.
# save_path har en sti som er den mappe man befinder sig i nu og hopper derfra ind i mappen "downloaded"
def download_txt(url, save_path='./downloaded'):
# vi laver et response object som er den hjemmeside vi får fra requests.get(url)
    response = requests.get(url)
# her åbner vi en fil til skrive kun i binært format. Vi overskriver filen, hvis filen findes.
# Hvis filen ikke findes, opretter vi en ny fil til skrivning.
# og vi refere til denne fil som f
    with open(save_path, 'wb') as f:
# her skriver vi så det indhold som findes i response ind i vores fil f.
        f.write(response.content)

# her definerer vi en metode kaldet generate_csv som tagere to parametre txt_input_path og csv_output_path
def generate_csv(txt_input_path, csv_output_path):
# her åbner vi en fil som vi får fra vores parameter txt_input_path og siger den skal skrives i utf-8 format og vi vil referer til filen som f
    with open(txt_input_path, encoding='utf-8') as f:
# vi laver et objekt txt_content som indeholder teksten fra vores fil f
        txt_content = f.readlines()
# her laver vi et todimensionelt array og som indeholderen 5 værdier i den første række
    rows = [['street', 'city', 'price', 'sqm', 'price_per_sqm']]
# her laver vi en for-lykke som køre igennem hver linie i txt_content
    for line in txt_content:
# her sætter vi line til at være lig med line, men hvor vi har fjernet '  * ' og erstatet det med ''
        line = line.rstrip().replace('  * ', '')
# her splitter vi line på tab og sætter den forskellige substrings til address, price og sqm
        address, price, sqm = line.split('\t')
# her splitter vi så address hvor vi har  '; ' og sætter substringsne til street og city
        street, city = address.split('; ')
# vi laver en ny variabel price_per_sqm som er lig med price divideret med sqm. vi bruger to forwardslash for at få værdien som heltal
        price_per_sqm = int(price) // int(sqm)
# vi laver en række som består af street, city, price, sqm og price_per_sqm
        row = (street, city, price, sqm, price_per_sqm)
# herefter indsætter vi rækken i vores array
        rows.append(row)

# her har vi et if statement som tjekker om operativsystemet som koden bliver kørt på er Windows
    if platform.system() == 'Windows':
# hvis den er det bliver newline sat til en tom string
        newline=''
    else:
# hvis det ikke er Windows, bliver newline sat til None, som er det samme som mange andre sprogs NULL værdi
        newline=None

# her åbner vi en fil i skrivetilstand, vi referer til filen som csv_output_path.
# Vi fortæller med newline=newline hvordan vi ønsker at terminate en linie da dette skal gøres forskelligt afhængig af om vi bruger windows eller ej
# vi ønsker at skrive i utf-8 format, og så vil vi gerne referer til filen som f
    with open(csv_output_path, 'w', newline=newline, encoding='utf-8') as f:
# her laver vi et writer object kaldet output_writer som skal bruges til at skrive til f i csv format
        output_writer = csv.writer(f)
# vi køre igennem en for-lykke
        for row in rows:
# og siger for hver row i rows skal vi skrive vores row til output_writer
            output_writer.writerow(row)

# Vi definerer en metode kaldet read_prices, metoden tager et parameter kaldet csv_input_path
def read_prices(csv_input_path):
# vi åbner en fil csv_input_path med utf-8 encoding, og vi vil referertil filen som f
    with open(csv_input_path, encoding='utf-8') as f:
#vi laver et reader objekt som kan læse vores csv fil f
        reader = csv.reader(f)
# vi bruger next(reader) til at springe over den første linie i vores csv fil.
# vi bruger _ som en "smid væk variabel"
        _ = next(reader)

# vi laver et array kaldet idxs
        idxs = []
# vi laver et array kaldet prices
        prices = []
# vi laver en for-lykke på vores reader
        for row in reader:
# vi bruger underscore som en "smid væk variabel", så vi er kun interesseret i price variablen fra vores row
            _, _, price, _, _ = row
# vi gemmer linie nummeret fra reader i vores indxs array
            idxs.append(reader.line_num)
# vi gemmer price variablen som en int i vores prices array
            prices.append(int(price))
#til sidst returnere vi en liste af datasæt bestående af idxs og prices
    return list(zip(idxs, prices))

# vi definerer en metode kaldet compute_avg_price som tager et parameter data
def compute_avg_price(data):
# vi unzipper vores data, og siger vi kun er interesseret i prices
    _, prices = zip(*data)
# vi beregner gennemsnitspriserne fra data og gemmer det i en variabel avg_price
    avg_price = statistics.mean(prices)
# vi åbner en fil /tmp/avg_price.txt i skrivetilstand i utf-8 encoding og vil refere til den som f
    with open('/tmp/avg_price.txt', 'w', encoding='utf-8') as f:
# her skriver vi så avg_price ind i filen som en string
        f.write(str(avg_price))
# til sidst returnere vi avg_price
    return avg_price

# vi definerer en metode generate_plot som tager data som parameter
def generate_plot(data):
# vi unzipper data og gennem dens to værdier som x_values og y_values
    x_values, y_values = zip(*data)
# vi opretter en figur
    fig = plt.figure()
# vi indsætter x og y værdierne som et koordinat i vores figur med en prik der har en størelse på 100
    plt.scatter(x_values, y_values, s=100)
# til sidst gemmer vi figuren som prices.png i det directory vi befinder os i.
# vi bruger bbox_inches='tight' til at fjerne alt den overskydende plads rund om vores figur
    fig.savefig('./prices.png', bbox_inches='tight')

# vi laver en run metode
def run():
# vi gemmer en url til en txt fil i en variable file_url
    file_url = 'https://raw.githubusercontent.com/datsoftlyngby/' \
               'soft2017fall-business-intelligence-teaching-material/master/' \
               'assignments/assignment_1/price_list.txt'
# os.path.basename(file_url) giver os navnet på den fil der befinder sig på denne sti. vi gemmer så navnet i txt_file_name
    txt_file_name = os.path.basename(file_url)
# os.path.join('./', txt_file_name) kombinere den sti vi befinder os i med txt_file_name og gemmer så den sammensatte sti i txt_path
    txt_path = os.path.join('./', txt_file_name)
# vi kalder vores download_txt metode og giver den file_url og txt_path som parametre
    download_txt(file_url, txt_path)
# vi laver en string
    csv_file_name = 'price_list.csv'
# os.getcwd returnere vores nuværende directory som en string, denne string kombinere vi med csv_file_name og gemmer den sammensatte sti i csv_path
    csv_path = os.path.join(os.getcwd(), csv_file_name)
# vi kalder vores generate_csv med parametrene txt_path og csv_path
    generate_csv(txt_path, csv_path)
# vi laver en liste hvor vi kan gemme resultaterne fra vores read_prices metode, denne metode tager stien til vores csv fil som parameter
    data = read_prices(csv_path)
# vi gemmer resultatet fra vores compute_avg_price metode i avg_price. avg_price tager data som parameter
    avg_price = compute_avg_price(data)
# vi udskriver avg_price
    print(avg_price)
# vi kalder vores metode generate_plot som tager data som parameter
    generate_plot(data)

# her har vi en condition der tjekker om vores __name__ variable er lig med '__main__'
if __name__ == '__main__':
# og til sidst køre vi hele programmet
    run()
```
